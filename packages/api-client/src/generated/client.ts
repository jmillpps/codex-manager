// Auto-generated by scripts/generate-client.mjs.
// Do not edit this file manually.

export const apiVersion = "0.9.0";

export type ApiHealth = {
  status: string;
  service: string;
  timestamp: string;
  codex: {
    running: boolean;
    pid: number | null;
    initialized: boolean;
  };
  auth: {
    hasOpenAiApiKey: boolean;
    codexHomeAuthFile: boolean;
    likelyUnauthenticated: boolean;
  };
};

export type SessionSummary = {
  sessionId: string;
  title: string;
  materialized: boolean;
  modelProvider: string;
  createdAt: number;
  updatedAt: number;
  cwd: string;
  source: string;
  projectId: string | null;
};

export type ProjectSummary = {
  projectId: string;
  name: string;
  createdAt: string;
  updatedAt: string;
};

export type TranscriptEntry = {
  messageId: string;
  turnId: string;
  role: "user" | "assistant" | "system";
  type: string;
  content: string;
  details?: string;
  status: "streaming" | "complete" | "canceled" | "error";
};

export type SessionDetail = {
  session: SessionSummary;
  thread: unknown;
  transcript: Array<TranscriptEntry>;
};

export type PendingApproval = {
  approvalId: string;
  method: string;
  threadId: string;
  turnId: string | null;
  itemId: string | null;
  summary: string;
  details: Record<string, unknown>;
  createdAt: string;
  status: "pending";
};

export type ModelEntry = Record<string, unknown>;
export type McpServerStatusEntry = Record<string, unknown>;

export async function fetchApiHealth(baseUrl = "/api"): Promise<ApiHealth> {
  const response = await fetch(`${baseUrl}/health`);
  if (!response.ok) {
    throw new Error(`health request failed (${response.status})`);
  }

  return (await response.json()) as ApiHealth;
}

export async function listModels(
  baseUrl = "/api",
  options: { cursor?: string; limit?: number } = {}
): Promise<{ data: Array<ModelEntry>; nextCursor: string | null }> {
  const query = new URLSearchParams();
  if (typeof options.cursor === "string" && options.cursor.length > 0) {
    query.set("cursor", options.cursor);
  }
  if (typeof options.limit === "number" && Number.isFinite(options.limit)) {
    query.set("limit", String(options.limit));
  }

  const suffix = query.toString();
  const response = await fetch(`${baseUrl}/models${suffix ? `?${suffix}` : ""}`);
  if (!response.ok) {
    throw new Error(`list models failed (${response.status})`);
  }

  return (await response.json()) as { data: Array<ModelEntry>; nextCursor: string | null };
}

export async function listMcpServers(
  baseUrl = "/api",
  options: { cursor?: string; limit?: number } = {}
): Promise<{ data: Array<McpServerStatusEntry>; nextCursor: string | null }> {
  const query = new URLSearchParams();
  if (typeof options.cursor === "string" && options.cursor.length > 0) {
    query.set("cursor", options.cursor);
  }
  if (typeof options.limit === "number" && Number.isFinite(options.limit)) {
    query.set("limit", String(options.limit));
  }

  const suffix = query.toString();
  const response = await fetch(`${baseUrl}/mcp/servers${suffix ? `?${suffix}` : ""}`);
  if (!response.ok) {
    throw new Error(`list mcp servers failed (${response.status})`);
  }

  return (await response.json()) as { data: Array<McpServerStatusEntry>; nextCursor: string | null };
}

export async function listProjects(baseUrl = "/api"): Promise<{ data: Array<ProjectSummary> }> {
  const response = await fetch(`${baseUrl}/projects`);
  if (!response.ok) {
    throw new Error(`list projects failed (${response.status})`);
  }

  return (await response.json()) as { data: Array<ProjectSummary> };
}

export async function createProject(name: string, baseUrl = "/api"): Promise<{ status: string; project: ProjectSummary }> {
  const response = await fetch(`${baseUrl}/projects`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({ name })
  });

  if (!response.ok) {
    throw new Error(`create project failed (${response.status})`);
  }

  return (await response.json()) as { status: string; project: ProjectSummary };
}

export async function renameProject(
  projectId: string,
  name: string,
  baseUrl = "/api"
): Promise<{ status: string; project: ProjectSummary }> {
  const response = await fetch(`${baseUrl}/projects/${encodeURIComponent(projectId)}/rename`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({ name })
  });

  if (!response.ok) {
    throw new Error(`rename project failed (${response.status})`);
  }

  return (await response.json()) as { status: string; project: ProjectSummary };
}

export async function deleteProject(
  projectId: string,
  baseUrl = "/api"
): Promise<{ status: string; projectId: string; unassignedSessionCount?: number }> {
  const response = await fetch(`${baseUrl}/projects/${encodeURIComponent(projectId)}`, {
    method: "DELETE"
  });

  if (!response.ok) {
    throw new Error(`delete project failed (${response.status})`);
  }

  return (await response.json()) as { status: string; projectId: string; unassignedSessionCount?: number };
}

export async function moveAllProjectChats(
  projectId: string,
  destination: "unassigned" | "archive",
  baseUrl = "/api"
): Promise<{
  status: string;
  projectId: string;
  destination: "unassigned" | "archive";
  movedSessionCount: number;
  archivedSessionCount?: number;
  alreadyArchivedSessionCount?: number;
}> {
  const response = await fetch(`${baseUrl}/projects/${encodeURIComponent(projectId)}/chats/move-all`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({ destination })
  });

  if (!response.ok) {
    throw new Error(`move all project chats failed (${response.status})`);
  }

  return (await response.json()) as {
    status: string;
    projectId: string;
    destination: "unassigned" | "archive";
    movedSessionCount: number;
    archivedSessionCount?: number;
    alreadyArchivedSessionCount?: number;
  };
}

export async function deleteAllProjectChats(
  projectId: string,
  baseUrl = "/api"
): Promise<{ status: string; projectId: string; deletedSessionCount: number; skippedSessionCount: number }> {
  const response = await fetch(`${baseUrl}/projects/${encodeURIComponent(projectId)}/chats/delete-all`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({})
  });

  if (!response.ok) {
    throw new Error(`delete all project chats failed (${response.status})`);
  }

  return (await response.json()) as { status: string; projectId: string; deletedSessionCount: number; skippedSessionCount: number };
}

export async function listSessions(
  baseUrl = "/api",
  options: { archived?: boolean; cursor?: string; limit?: number } = {}
): Promise<{ data: Array<SessionSummary>; nextCursor: string | null; archived: boolean }> {
  const query = new URLSearchParams();
  if (options.archived) {
    query.set("archived", "true");
  }
  if (typeof options.cursor === "string" && options.cursor.length > 0) {
    query.set("cursor", options.cursor);
  }
  if (typeof options.limit === "number" && Number.isFinite(options.limit)) {
    query.set("limit", String(options.limit));
  }

  const suffix = query.toString();
  const response = await fetch(`${baseUrl}/sessions${suffix ? `?${suffix}` : ""}`);
  if (!response.ok) {
    throw new Error(`list sessions failed (${response.status})`);
  }

  return (await response.json()) as { data: Array<SessionSummary>; nextCursor: string | null; archived: boolean };
}

export async function createSession(baseUrl = "/api", body: { cwd?: string; model?: string } = {}): Promise<{ session: SessionSummary; thread: unknown }> {
  const response = await fetch(`${baseUrl}/sessions`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify(body)
  });

  if (!response.ok) {
    throw new Error(`create session failed (${response.status})`);
  }

  return (await response.json()) as { session: SessionSummary; thread: unknown };
}

export async function readSession(sessionId: string, baseUrl = "/api"): Promise<SessionDetail> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}`);
  if (!response.ok) {
    throw new Error(`read session failed (${response.status})`);
  }

  return (await response.json()) as SessionDetail;
}

export async function deleteSession(
  sessionId: string,
  baseUrl = "/api"
): Promise<{ status: string; sessionId: string; title?: string | null; deletedFileCount?: number }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}`, {
    method: "DELETE"
  });

  if (!response.ok) {
    throw new Error(`delete session failed (${response.status})`);
  }

  return (await response.json()) as { status: string; sessionId: string; title?: string | null; deletedFileCount?: number };
}

export async function renameSession(sessionId: string, title: string, baseUrl = "/api"): Promise<{ status: string; session: SessionSummary }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}/rename`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({ title })
  });

  if (!response.ok) {
    throw new Error(`rename session failed (${response.status})`);
  }

  return (await response.json()) as { status: string; session: SessionSummary };
}

export async function setSessionProject(
  sessionId: string,
  projectId: string | null,
  baseUrl = "/api"
): Promise<{ status: string; sessionId: string; projectId: string | null; previousProjectId?: string | null }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}/project`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({ projectId })
  });

  if (!response.ok) {
    throw new Error(`set session project failed (${response.status})`);
  }

  return (await response.json()) as {
    status: string;
    sessionId: string;
    projectId: string | null;
    previousProjectId?: string | null;
  };
}

export async function archiveSession(sessionId: string, baseUrl = "/api"): Promise<{ status: string; sessionId: string }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}/archive`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({})
  });

  if (!response.ok) {
    throw new Error(`archive session failed (${response.status})`);
  }

  return (await response.json()) as { status: string; sessionId: string };
}

export async function unarchiveSession(sessionId: string, baseUrl = "/api"): Promise<{ status: string; session: SessionSummary; thread: unknown }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}/unarchive`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({})
  });

  if (!response.ok) {
    throw new Error(`unarchive session failed (${response.status})`);
  }

  return (await response.json()) as { status: string; session: SessionSummary; thread: unknown };
}

export async function listSessionApprovals(sessionId: string, baseUrl = "/api"): Promise<{ data: Array<PendingApproval> }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}/approvals`);
  if (!response.ok) {
    throw new Error(`list approvals failed (${response.status})`);
  }

  return (await response.json()) as { data: Array<PendingApproval> };
}

export async function sendSessionMessage(
  sessionId: string,
  text: string,
  baseUrl = "/api",
  model?: string
): Promise<{ status: string; sessionId: string; turnId: string }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}/messages`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({ text, model })
  });

  if (!response.ok) {
    throw new Error(`send message failed (${response.status})`);
  }

  return (await response.json()) as { status: string; sessionId: string; turnId: string };
}

export async function interruptSession(sessionId: string, baseUrl = "/api"): Promise<{ status: string; sessionId: string; turnId?: string }> {
  const response = await fetch(`${baseUrl}/sessions/${encodeURIComponent(sessionId)}/interrupt`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({})
  });

  if (!response.ok && response.status !== 409) {
    throw new Error(`interrupt session failed (${response.status})`);
  }

  return (await response.json()) as { status: string; sessionId: string; turnId?: string };
}

export async function decideApproval(
  approvalId: string,
  decision: "accept" | "decline" | "cancel",
  scope: "turn" | "session" = "turn",
  baseUrl = "/api"
): Promise<{ status: string; approvalId: string; threadId?: string }> {
  const response = await fetch(`${baseUrl}/approvals/${encodeURIComponent(approvalId)}/decision`, {
    method: "POST",
    headers: {
      "content-type": "application/json"
    },
    body: JSON.stringify({ decision, scope })
  });

  if (!response.ok) {
    throw new Error(`decide approval failed (${response.status})`);
  }

  return (await response.json()) as { status: string; approvalId: string; threadId?: string };
}
